<!--
Copyright (c) 2026 山野小娃 (Jorney Ruan)

本文档采用 CC BY 4.0 协议。您可以自由分享和修改，但需保留署名。
-->

# SACP 结构化AI协同协议 V1.0 规范

## 1. 协议概述

### 1.1 协议定位
SACP（Structured AI Collaboration Protocol）是一套开放、可扩展、标准化的AI原生协同技术协议，定义了AI驱动场景下，跨系统、跨软件的结构化数据模型、交互规范与安全准则。任何软件（传统办公软件、AI工具、业务系统、开发者工具）只要遵循本协议，即可实现无缝的AI协同、数据互通、执行结果统一沉淀，彻底打破AI时代的系统数据孤岛。

### 1.2 协议目标
- 解决AI输出无序、格式不统一、跨系统无法互通的行业痛点；
- 为所有软件提供一套开箱即用的AI协同标准化方案，降低AI协同的开发与接入成本；
- 构建开放的AI协同生态，实现「一次标准化，全场景协同」。

### 1.3 适用范围
- 传统软件：OA系统、财务报销、差旅管理、ERP、CRM、知识库等；
- AI原生工具：大模型应用、AI执行工具（如OpenClaw）、AI知识库、BI数据分析工具等；
- 开发者工具：代码托管、CI/CD、项目管理工具等；
- 个人生产力工具：待办清单、日历、笔记软件等。

## 2. 核心设计原则

1. **强约束核心，弱侵入扩展**：核心数据模型严格标准化，保证互通性；扩展字段完全开放，适配不同场景的个性化需求，不破坏核心结构。
2. **安全原生**：协议原生定义数据安全、权限隔离、加密传输准则，从根源规避AI协同的安全风险。
3. **100%向下兼容**：协议所有版本迭代，核心数据模型完全向下兼容，老接入方无需修改代码即可适配新版本。
4. **极简接入**：协议提供标准化的API接口、多语言SDK，接入方仅需完成数据格式转换，即可实现协议适配，最低开发成本。

## 3. 核心数据模型规范（协议灵魂，强制约束）

SACP协议定义了7种核心标准数据结构，所有接入方必须严格遵循，这是跨系统协同的基础。所有结构均包含必填核心字段与可选扩展字段`extend`，必填字段不可修改、不可缺失，扩展字段可按需自定义。

### 3.1 通用字段规范
所有7种结构均包含以下通用字段：

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| `type` | string | 是 | 数据类型，固定为 `task`/`report`/`output`/`message`/`approval`/`schedule`/`metric` 七选一 |
| `title` | string | 是 | 标题，不超过100字符 |
| `create_time` | string | 是 | 创建时间，标准ISO 8601格式：`yyyy-MM-dd HH:mm:ss` |
| `update_time` | string | 是 | 更新时间，标准ISO 8601格式 |
| `creator` | string | 否 | 创建人ID/标识 |
| `source` | string | 否 | 数据来源系统标识，如 `OpenClaw`/`企业OA` |
| `extend` | object | 否 | 标准化扩展字段，用于适配不同场景的个性化需求，不破坏核心结构 |

### 3.2 7种核心结构详细规范

#### 3.2.1 `task` 任务执行类
**核心定位**：表示需要执行的任务、待办事项、开发任务等。

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| `description` | string | 是 | 任务详细描述 |
| `priority` | string | 是 | 优先级：`高`/`中`/`低` |
| `status` | string | 是 | 状态：`todo`/`doing`/`confirm`/`done`/`archived` |
| `progress` | integer | 是 | 进度百分比，0-100 |
| `from_command` | string | 否 | 生成该任务的原始指令 |
| `output_expect` | string | 否 | 预期输出或成果描述 |

#### 3.2.2 `report` 文档报告类
**核心定位**：表示分析报告、方案文档、总结、知识沉淀等。

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| `tags` | array[string] | 否 | 标签列表 |
| `outline` | array[string] | 否 | 大纲（章节标题列表） |
| `summary` | string | 否 | 摘要/简介 |
| `content` | string | 是 | Markdown格式的完整内容 |
| `from_task` | string | 否 | 关联的任务ID（如由某任务生成） |

#### 3.2.3 `output` 成果交付类
**核心定位**：表示代码、文件、图片、链接等交付物。

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| `category` | string | 是 | 类别：`code`/`file`/`image`/`link` |
| `content` | string | 条件必填 | 当`category`为`code`或`link`时，此处存放代码文本或URL；其他类别可为空 |
| `language` | string | 否 | 代码语言（当`category=code`时建议填写） |
| `url` | string | 条件必填 | 当`category`为`file`/`image`时，此为文件访问URL；当`category`为`link`时，此为链接地址 |
| `file_size` | integer | 否 | 文件大小（字节），仅对`file`/`image`有效 |
| `from_task` | string | 否 | 关联的任务ID |

#### 3.2.4 `message` 通知消息类
**核心定位**：用于简短通知、状态提醒等，不承载核心业务数据。

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| `text` | string | 是 | 通知内容，不超过2行（建议140字符内） |

#### 3.2.5 `approval` 审批流程类
**核心定位**：表示各类审批申请（报销、请假、合同等）。

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| `apply_type` | string | 是 | 申请类型，如 `报销`/`请假`/`合同` |
| `applicant` | string | 是 | 申请人ID |
| `approver_list` | array[string] | 是 | 审批人ID列表（按顺序） |
| `current_approver` | string | 否 | 当前待审批人ID |
| `status` | string | 是 | 状态：`pending`/`approving`/`approved`/`rejected`/`cancelled` |
| `content` | string | 是 | 申请内容描述 |
| `amount` | number | 否 | 涉及金额（如报销、采购） |
| `start_time` | string | 否 | 开始时间（如请假） |
| `end_time` | string | 否 | 结束时间（如请假） |

#### 3.2.6 `schedule` 日程待办类
**核心定位**：表示会议、提醒、周期任务等。

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| `description` | string | 否 | 详细说明 |
| `start_time` | string | 是 | 开始时间 |
| `end_time` | string | 是 | 结束时间 |
| `status` | string | 是 | 状态：`scheduled`/`ongoing`/`completed`/`cancelled` |
| `priority` | string | 否 | 优先级：`高`/`中`/`低` |
| `remind_time` | string | 否 | 提醒时间（ISO 8601） |
| `cycle_rule` | string | 否 | 周期性规则，如 `每日`/`每周一`/`每月1日` |
| `participant_list` | array[string] | 否 | 参与人ID列表 |

#### 3.2.7 `metric` 数据指标类
**核心定位**：表示运营指标、财务数据、项目进度等统计数据。

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| `stat_cycle` | string | 是 | 统计周期，如 `2026-02`（月度）、`2026-W08`（周度） |
| `data_source` | string | 否 | 数据来源系统 |
| `metric_list` | array[object] | 是 | 指标数组，每个指标包含`name`(指标名)、`value`(数值)、`unit`(单位) |

## 4. 交互规范（技术实现约定）

SACP协议定义了两种标准化交互模式，覆盖所有协同场景，接入方可按需实现。

### 4.1 模式一：RESTful API 主动调用规范

所有接口统一前缀：`/api/v1/sacp/`，所有请求必须携带协议认证头，强制HTTPS传输。

#### 4.1.1 通用认证规范
- 每个接入方需生成 `SACP-API-Key` 与 `SACP-API-Secret`，用于身份认证；
- 所有请求Header必须携带以下参数：
  - `X-SACP-API-Key`：接入方的API Key
  - `X-SACP-Signature`：请求体+时间戳+API Secret生成的SHA256签名，防止数据篡改
  - `X-SACP-Timestamp`：当前时间戳，10分钟内有效

#### 4.1.2 核心接口规范
| 接口端点 | 请求方式 | 核心功能 |
|----------|----------|----------|
| `/data/write` | POST | 单条标准化数据写入，支持7种结构的任意类型 |
| `/data/batch-write` | POST | 批量标准化数据写入，支持混合类型 |
| `/data/list` | GET | 按类型、时间、关键词分页查询数据列表 |
| `/data/detail` | GET | 按ID查询单条数据的完整详情 |
| `/data/update` | PUT | 更新单条数据的状态、内容 |
| `/data/delete` | DELETE | 删除单条数据 |

### 4.2 模式二：Webhook 事件推送规范

协议定义了标准化的事件推送机制，用于实现系统间的实时数据同步，无需轮询。

#### 4.2.1 支持的事件类型
- `data.create`：新数据创建时触发
- `data.update`：数据更新时触发
- `data.delete`：数据删除时触发
- `status.change`：任务/审批/日程状态变更时触发

#### 4.2.2 推送规范
- 接入方需配置Webhook接收地址、事件类型、推送签名密钥；
- 推送内容为标准化的SACP数据结构，包含事件类型、触发时间、完整数据详情；
- 推送必须携带签名头，接收方需校验签名，防止恶意推送；
- 推送失败需实现重试机制，最多重试3次，间隔1分钟。

## 5. 安全规范（强制遵守）

1. **传输安全**：所有API请求、Webhook推送必须使用HTTPS协议，禁止HTTP明文传输；
2. **数据隔离**：接入方必须实现严格的数据隔离，不同用户、不同租户的数据完全隔离，禁止越权访问；
3. **签名校验**：所有请求与推送必须进行签名校验，防止数据篡改、重放攻击；
4. **权限最小化**：API Key必须按最小权限原则分配，仅开放必要的接口权限，支持IP白名单、QPS限流；
5. **敏感数据处理**：协议禁止传输用户的大模型API Key、账号密码等敏感信息，仅用于业务数据的协同互通；
6. **审计日志**：接入方必须保留完整的API调用、Webhook推送日志，用于合规审计、问题排查，日志保留时间不少于6个月。

## 6. 扩展规范

1. 所有扩展内容必须放在`extend`字段内，禁止修改核心字段；
2. 扩展字段必须使用清晰、无歧义的命名，禁止使用特殊字符；
3. 扩展字段不得影响核心结构的解析，接入方无法识别扩展字段时，必须正常解析核心字段；
4. 行业通用扩展字段，可通过协议迭代纳入标准化规范。

## 7. 官方实现与开源生态

1. **官方参考实现**：[ClawSync](https://github.com/yourname/clawsync) 硅基协同工作台是SACP协议的首个官方完整实现，提供了协议的全能力支持；
2. **多语言SDK**：官方提供Python、Node.js、Java、Go等多语言SDK，降低接入成本；
3. **开源协议**：SACP协议规范采用CC BY 4.0协议开源，可自由分享、演绎、商用，需保留署名；官方SDK与参考实现采用MIT协议开源。

## 8. 版本迭代规则

- 版本号格式：`主版本号.次版本号.修订号`
- **主版本号**：核心数据模型变更，不向下兼容时升级；
- **次版本号**：新增接口、扩展规范，完全向下兼容时升级；
- **修订号**：bug修复、文档优化，完全向下兼容时升级。

---

**作者：** 山野小娃 (Jorney Ruan)
**版权声明：** Copyright (c) 2026 山野小娃 (Jorney Ruan)
**许可协议：** 本文档遵循 CC BY 4.0 协议，您可以自由分享和修改，但需保留署名。
